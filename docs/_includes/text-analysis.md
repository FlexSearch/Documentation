
### Text analysis

In FlexSearch every field has an Analyzer consisting of:
 
- **Preprocessing Script** – A F# based script which can be used to clean the input data. This only runs at index time and not at the search time.

- **Tokenizer** – Splits incoming text in multiple tokens based on tokenization rule like white space.

- **Zero or more Filters** – Applies custom logic on each token like case conversion, synonym & stop word processing.

Let's consider a simple example, we have an input text "The quick brown fox jumps over the lazy dog". Let's process the text using a simple analyzer consisting of a white space tokeniser and few filters. The white space tokeniser breaks the input at whitespace boundaries resulting in creation of multiple tokens from the given input. There can only be a single tokeniser per analyzer.

And the end of tokenisation we have a series of tokens which can be fed into multiple filters. In our example the tokens first go through lowercase filter which converts all the tokens to lowercase. Now the resulting output is fed into a stop word filter which removes commonly used stop words. In our case the word `the`is removed. The resulting output then goes through a synonym filter which adds synonym for words quick and lazy.

<svg height="498px" style="width:424px;height:498px;" version="1.1" viewBox="0 0 424 498" width="424px"><defs><filter height="300%" id="f1" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#F8F8F8" filter="url(#f1)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="295" x="66" y="10"/><text fill="#000000" font-family="Roboto" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="275" x="76" y="31.1387">The quick brown fox jumps over the lazy dog</text><rect fill="#F8F8F8" filter="url(#f1)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="158" x="134.5" y="63.9688"/><text fill="#000000" font-family="Roboto" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="138" x="144.5" y="85.1074">White space tokenizer</text><rect fill="#F8F8F8" filter="url(#f1)" height="37.9688" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="374" x="26.5" y="117.9375"/><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="26" x="40.5" y="141.0762">The</text><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="37" x="74.5" y="141.0762">quick</text><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="45" x="119.5" y="141.0762">brown</text><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="172.5" y="141.0762">fox</text><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="42" x="201.5" y="141.0762">jumps</text><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="31" x="251.5" y="141.0762">over</text><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="24" x="290.5" y="141.0762">the</text><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="29" x="322.5" y="141.0762">lazy</text><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="359.5" y="141.0762">dog</text><line style="stroke: #000000; stroke-width: 1.5;" x1="36.5" x2="390.5" y1="129.9375" y2="129.9375"/><line style="stroke: #000000; stroke-width: 1.5;" x1="36.5" x2="390.5" y1="143.9063" y2="143.9063"/><line style="stroke: #000000; stroke-width: 1.5;" x1="36.5" x2="36.5" y1="129.9375" y2="143.9063"/><line style="stroke: #000000; stroke-width: 1.5;" x1="70.5" x2="70.5" y1="129.9375" y2="143.9063"/><line style="stroke: #000000; stroke-width: 1.5;" x1="115.5" x2="115.5" y1="129.9375" y2="143.9063"/><line style="stroke: #000000; stroke-width: 1.5;" x1="168.5" x2="168.5" y1="129.9375" y2="143.9063"/><line style="stroke: #000000; stroke-width: 1.5;" x1="197.5" x2="197.5" y1="129.9375" y2="143.9063"/><line style="stroke: #000000; stroke-width: 1.5;" x1="247.5" x2="247.5" y1="129.9375" y2="143.9063"/><line style="stroke: #000000; stroke-width: 1.5;" x1="286.5" x2="286.5" y1="129.9375" y2="143.9063"/><line style="stroke: #000000; stroke-width: 1.5;" x1="318.5" x2="318.5" y1="129.9375" y2="143.9063"/><line style="stroke: #000000; stroke-width: 1.5;" x1="355.5" x2="355.5" y1="129.9375" y2="143.9063"/><line style="stroke: #000000; stroke-width: 1.5;" x1="390.5" x2="390.5" y1="129.9375" y2="143.9063"/><rect fill="#F8F8F8" filter="url(#f1)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="122" x="152.5" y="175.9063"/><text fill="#000000" font-family="Roboto" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="102" x="162.5" y="197.0449">Lower case filter</text><rect fill="#F8F8F8" filter="url(#f1)" height="37.9688" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="372" x="27.5" y="229.875"/><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="24" x="41.5" y="253.0137">the</text><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="37" x="73.5" y="253.0137">quick</text><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="45" x="118.5" y="253.0137">brown</text><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="171.5" y="253.0137">fox</text><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="42" x="200.5" y="253.0137">jumps</text><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="31" x="250.5" y="253.0137">over</text><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="24" x="289.5" y="253.0137">the</text><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="29" x="321.5" y="253.0137">lazy</text><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="358.5" y="253.0137">dog</text><line style="stroke: #000000; stroke-width: 1.5;" x1="37.5" x2="389.5" y1="241.875" y2="241.875"/><line style="stroke: #000000; stroke-width: 1.5;" x1="37.5" x2="389.5" y1="255.8438" y2="255.8438"/><line style="stroke: #000000; stroke-width: 1.5;" x1="37.5" x2="37.5" y1="241.875" y2="255.8438"/><line style="stroke: #000000; stroke-width: 1.5;" x1="69.5" x2="69.5" y1="241.875" y2="255.8438"/><line style="stroke: #000000; stroke-width: 1.5;" x1="114.5" x2="114.5" y1="241.875" y2="255.8438"/><line style="stroke: #000000; stroke-width: 1.5;" x1="167.5" x2="167.5" y1="241.875" y2="255.8438"/><line style="stroke: #000000; stroke-width: 1.5;" x1="196.5" x2="196.5" y1="241.875" y2="255.8438"/><line style="stroke: #000000; stroke-width: 1.5;" x1="246.5" x2="246.5" y1="241.875" y2="255.8438"/><line style="stroke: #000000; stroke-width: 1.5;" x1="285.5" x2="285.5" y1="241.875" y2="255.8438"/><line style="stroke: #000000; stroke-width: 1.5;" x1="317.5" x2="317.5" y1="241.875" y2="255.8438"/><line style="stroke: #000000; stroke-width: 1.5;" x1="354.5" x2="354.5" y1="241.875" y2="255.8438"/><line style="stroke: #000000; stroke-width: 1.5;" x1="389.5" x2="389.5" y1="241.875" y2="255.8438"/><rect fill="#F8F8F8" filter="url(#f1)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="115" x="156" y="287.8438"/><text fill="#000000" font-family="Roboto" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="95" x="166" y="308.9824">Stop word filter</text><rect fill="#F8F8F8" filter="url(#f1)" height="37.9688" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="372" x="27.5" y="341.8125"/><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="0" x="41.5" y="364.9512"/><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" text-decoration="line-through" textLength="24" x="41.5" y="364.9512">the</text><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="0" x="69.5" y="364.9512"/><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="37" x="73.5" y="364.9512">quick</text><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="45" x="118.5" y="364.9512">brown</text><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="171.5" y="364.9512">fox</text><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="42" x="200.5" y="364.9512">jumps</text><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="31" x="250.5" y="364.9512">over</text><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="0" x="289.5" y="364.9512"/><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" text-decoration="line-through" textLength="24" x="289.5" y="364.9512">the</text><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="0" x="317.5" y="364.9512"/><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="29" x="321.5" y="364.9512">lazy</text><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="358.5" y="364.9512">dog</text><line style="stroke: #000000; stroke-width: 1.5;" x1="37.5" x2="389.5" y1="353.8125" y2="353.8125"/><line style="stroke: #000000; stroke-width: 1.5;" x1="37.5" x2="389.5" y1="367.7813" y2="367.7813"/><line style="stroke: #000000; stroke-width: 1.5;" x1="37.5" x2="37.5" y1="353.8125" y2="367.7813"/><line style="stroke: #000000; stroke-width: 1.5;" x1="69.5" x2="69.5" y1="353.8125" y2="367.7813"/><line style="stroke: #000000; stroke-width: 1.5;" x1="114.5" x2="114.5" y1="353.8125" y2="367.7813"/><line style="stroke: #000000; stroke-width: 1.5;" x1="167.5" x2="167.5" y1="353.8125" y2="367.7813"/><line style="stroke: #000000; stroke-width: 1.5;" x1="196.5" x2="196.5" y1="353.8125" y2="367.7813"/><line style="stroke: #000000; stroke-width: 1.5;" x1="246.5" x2="246.5" y1="353.8125" y2="367.7813"/><line style="stroke: #000000; stroke-width: 1.5;" x1="285.5" x2="285.5" y1="353.8125" y2="367.7813"/><line style="stroke: #000000; stroke-width: 1.5;" x1="317.5" x2="317.5" y1="353.8125" y2="367.7813"/><line style="stroke: #000000; stroke-width: 1.5;" x1="354.5" x2="354.5" y1="353.8125" y2="367.7813"/><line style="stroke: #000000; stroke-width: 1.5;" x1="389.5" x2="389.5" y1="353.8125" y2="367.7813"/><rect fill="#F8F8F8" filter="url(#f1)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="107" x="160" y="399.7813"/><text fill="#000000" font-family="Roboto" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="87" x="170" y="420.9199">Synonym filter</text><rect fill="#F8F8F8" filter="url(#f1)" height="37.9688" rx="12.5" ry="12.5" style="stroke: #383838; stroke-width: 1.5;" width="407" x="10" y="453.75"/><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="69" x="24" y="476.8887">quick/fast</text><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="45" x="101" y="476.8887">brown</text><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="154" y="476.8887">fox</text><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="42" x="183" y="476.8887">jumps</text><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="31" x="233" y="476.8887">over</text><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="96" x="272" y="476.8887">lazy/lethargic</text><text fill="#000000" font-family="Roboto" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="376" y="476.8887">dog</text><line style="stroke: #000000; stroke-width: 1.5;" x1="20" x2="407" y1="465.75" y2="465.75"/><line style="stroke: #000000; stroke-width: 1.5;" x1="20" x2="407" y1="479.7188" y2="479.7188"/><line style="stroke: #000000; stroke-width: 1.5;" x1="20" x2="20" y1="465.75" y2="479.7188"/><line style="stroke: #000000; stroke-width: 1.5;" x1="97" x2="97" y1="465.75" y2="479.7188"/><line style="stroke: #000000; stroke-width: 1.5;" x1="150" x2="150" y1="465.75" y2="479.7188"/><line style="stroke: #000000; stroke-width: 1.5;" x1="179" x2="179" y1="465.75" y2="479.7188"/><line style="stroke: #000000; stroke-width: 1.5;" x1="229" x2="229" y1="465.75" y2="479.7188"/><line style="stroke: #000000; stroke-width: 1.5;" x1="268" x2="268" y1="465.75" y2="479.7188"/><line style="stroke: #000000; stroke-width: 1.5;" x1="372" x2="372" y1="465.75" y2="479.7188"/><line style="stroke: #000000; stroke-width: 1.5;" x1="407" x2="407" y1="465.75" y2="479.7188"/><line style="stroke: #383838; stroke-width: 1.5;" x1="213.5" x2="213.5" y1="43.9688" y2="63.9688"/><polygon fill="#383838" points="209.5,53.9688,213.5,63.9688,217.5,53.9688,213.5,57.9688" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="213.5" x2="213.5" y1="97.9375" y2="117.9375"/><polygon fill="#383838" points="209.5,107.9375,213.5,117.9375,217.5,107.9375,213.5,111.9375" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="213.5" x2="213.5" y1="155.9063" y2="175.9063"/><polygon fill="#383838" points="209.5,165.9063,213.5,175.9063,217.5,165.9063,213.5,169.9063" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="213.5" x2="213.5" y1="209.875" y2="229.875"/><polygon fill="#383838" points="209.5,219.875,213.5,229.875,217.5,219.875,213.5,223.875" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="213.5" x2="213.5" y1="267.8438" y2="287.8438"/><polygon fill="#383838" points="209.5,277.8438,213.5,287.8438,217.5,277.8438,213.5,281.8438" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="213.5" x2="213.5" y1="321.8125" y2="341.8125"/><polygon fill="#383838" points="209.5,331.8125,213.5,341.8125,217.5,331.8125,213.5,335.8125" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="213.5" x2="213.5" y1="379.7813" y2="399.7813"/><polygon fill="#383838" points="209.5,389.7813,213.5,399.7813,217.5,389.7813,213.5,393.7813" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.5;" x1="213.5" x2="213.5" y1="433.75" y2="453.75"/><polygon fill="#383838" points="209.5,443.75,213.5,453.75,217.5,443.75,213.5,447.75" style="stroke: #383838; stroke-width: 1.0;"/></g></svg>

<div class="hidden">
@startuml
skinparam monochrome true
skinparam defaultFontName Roboto

:The quick brown fox jumps over the lazy dog;
:White space tokenizer;
:| The | quick | brown | fox | jumps | over | the | lazy | dog |;
:Lower case filter;
:| the | quick | brown | fox | jumps | over | the | lazy | dog |;
:Stop word filter;
:| --the-- | quick | brown | fox | jumps | over | --the-- | lazy | dog |;
:Synonym filter;
:| quick/fast | brown | fox | jumps | over | lazy/lethargic | dog |;

@enduml
</div>